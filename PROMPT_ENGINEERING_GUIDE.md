# üéØ Prompt Engineering Toolkit - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

**–í–µ—Ä—Å–∏—è:** 1.0.0
**–î–∞—Ç–∞:** 22.11.2025
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫](#—Ä–∞—Å—á—ë—Ç-–º–µ—Ç—Ä–∏–∫)
5. [A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#ab-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
6. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø—Ä–æ–º–ø—Ç–∞–º–∏)
7. [CLI –∫–æ–º–∞–Ω–¥—ã](#cli-–∫–æ–º–∞–Ω–¥—ã)
8. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
9. [Best Practices](#best-practices)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

**Prompt Engineering Toolkit** - –ø–æ–ª–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–µ–Ω–µ—Ä–∞ –≤ ConstructionAI.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

‚úÖ **Metrics Calculator** - –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ (F1, Precision, Recall, BLEU, Similarity)
‚úÖ **A/B Testing Framework** - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–æ–º–ø—Ç–æ–≤ —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç—å—é
‚úÖ **Prompt Manager** - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ (semver), –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, rollback
‚úÖ **CLI Interface** - –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
‚úÖ **Experiment Tracking** - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –æ—Ç—á—ë—Ç–∞–º–∏
‚úÖ **Ground Truth Datasets** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

```
ConstructionAI_System/
‚îú‚îÄ‚îÄ prompt_engineering/          # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ metrics_calculator.py    # –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ ab_testing.py            # A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ prompt_manager.py        # –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ experiments/             # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã A/B —Ç–µ—Å—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ prompts/                 # –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–æ–º–ø—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ground_truth/            # –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ reports/                 # –û—Ç—á—ë—Ç—ã
‚îú‚îÄ‚îÄ prompt_engineering_cli.py    # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ PROMPT_ENGINEERING_GUIDE.md  # –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
```

---

## üõ† –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Metrics Calculator

**–§–∞–π–ª:** `prompt_engineering/metrics_calculator.py`

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**

#### Classification Metrics
- **Precision** = TP / (TP + FP)
- **Recall** = TP / (TP + FN)
- **F1 Score** = 2 √ó (Precision √ó Recall) / (Precision + Recall)
- **Accuracy** = (TP + TN) / (TP + TN + FP + FN)

#### Text Similarity
- **BLEU-1** - Unigram precision
- **Exact Match** - –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- **Fuzzy Match** - –°—Ö–æ–∂–µ—Å—Ç—å –ø–æ Levenshtein
- **Word Overlap** - –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å–ª–æ–≤

#### Link Quality
- **Exact Match Ratio** - –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ URL
- **Domain Match** - –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞
- **Params Match** - –ù–∞–ª–∏—á–∏–µ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (lr=54, /ekaterinburg, etc.)

#### Category Matching
- **Exact Match** - –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **Fuzzy Match** - –°—Ö–æ–∂–µ—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**API:**
```python
from prompt_engineering.metrics_calculator import MetricsCalculator

calc = MetricsCalculator()

# Classification
result = calc.calculate_classification_metrics(
    true_positives=45,
    false_positives=5,
    false_negatives=10,
    true_negatives=40
)
print(f"F1 Score: {result.f1_score:.3f}")

# Text Similarity
similarity = calc.calculate_text_similarity(
    predicted="Bosch GSR 12V-15",
    ground_truth="Bosch GSR 12V-15 –î—Ä–µ–ª—å"
)
print(f"BLEU-1: {similarity['bleu_1']:.3f}")

# Link Accuracy
link_acc = calc.calculate_link_accuracy(
    predicted_links=[...],
    ground_truth_links=[...],
    check_params=True
)
print(f"Exact Match: {link_acc['exact_match_ratio']:.3f}")
```

---

### 2. A/B Testing Framework

**–§–∞–π–ª:** `prompt_engineering/ab_testing.py`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ó–∞–ø—É—Å–∫ A/B —Ç–µ—Å—Ç–æ–≤ –º–µ–∂–¥—É –¥–≤—É–º—è –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è —Å —É—Ä–æ–≤–Ω–µ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤

**API:**
```python
from prompt_engineering.ab_testing import ABTester, PromptVariant

tester = ABTester()

# –°–æ–∑–¥–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã
variant_a = PromptVariant(
    name="baseline_v1",
    prompt_text="–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä.",
    version="1.0",
    description="–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç"
)

variant_b = PromptVariant(
    name="optimized_v2",
    prompt_text="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–æ–≤–∞—Ä –¥–µ—Ç–∞–ª—å–Ω–æ...",
    version="2.0",
    description="–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç"
)

# –ó–∞–ø—É—Å—Ç–∏—Ç—å A/B —Ç–µ—Å—Ç
report = tester.run_ab_test(
    test_name="vision_optimization",
    variant_a=variant_a,
    variant_b=variant_b,
    test_data=[...],
    executor_func=lambda prompt, data: execute_vision_api(prompt, data),
    metrics_func=lambda output, data: calculate_metrics(output, data)
)

print(f"–ü–æ–±–µ–¥–∏—Ç–µ–ª—å: {report.winner}")
print(f"–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {report.confidence*100:.1f}%")
```

---

### 3. Prompt Manager

**–§–∞–π–ª:** `prompt_engineering/prompt_manager.py`

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤ (semantic versioning)
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π (diff)
- –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –≤–µ—Ä—Å–∏—è–º
- –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –ø—Ä–æ–º–ø—Ç–æ–≤

**API:**
```python
from prompt_engineering.prompt_manager import PromptManager

manager = PromptManager()

# –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç
v1 = manager.create_prompt(
    prompt_name="vision_product_detection",
    prompt_text="–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ.",
    description="–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç",
    author="john_doe"
)
# ‚Üí –≤–µ—Ä—Å–∏—è 1.0.0

# –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç
v2 = manager.update_prompt(
    prompt_name="vision_product_detection",
    prompt_text="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞...",
    description="–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
    version_type="minor"  # major/minor/patch
)
# ‚Üí –≤–µ—Ä—Å–∏—è 1.1.0

# –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–º–ø—Ç
prompt = manager.get_prompt("vision_product_detection", version="1.0.0")

# –°—Ä–∞–≤–Ω–∏—Ç—å –≤–µ—Ä—Å–∏–∏
comparison = manager.compare_versions(
    "vision_product_detection",
    "1.0.0",
    "1.1.0"
)
print(f"–°—Ö–æ–∂–µ—Å—Ç—å: {comparison['similarity']*100:.1f}%")

# –û—Ç–∫–∞—Ç
manager.rollback("vision_product_detection", target_version="1.0.0")
# ‚Üí —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é 1.1.1 —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º 1.0.0
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `venv`. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:

```bash
cd /home/ubuntu/ConstructionAI_System
source venv/bin/activate
pip install -r requirements.txt
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞

```bash
./prompt_engineering_cli.py prompt create \
  --name vision_v1 \
  --text "–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ." \
  --description "–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤"
```

### 3. –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–ø—Ç–æ–≤

```bash
./prompt_engineering_cli.py prompt list
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞

```bash
./prompt_engineering_cli.py prompt update \
  --name vision_v1 \
  --text "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ –¥–µ—Ç–∞–ª—å–Ω–æ..." \
  --description "–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏" \
  --version-type minor
```

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–º–ø—Ç–∞

```bash
./prompt_engineering_cli.py prompt show --name vision_v1
```

---

## üìä –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫

### –ü—Ä–∏–º–µ—Ä 1: Classification Metrics

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤

```python
from prompt_engineering.metrics_calculator import MetricsCalculator

calc = MetricsCalculator()

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
# - 45 —Ç–æ–≤–∞—Ä–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ (TP)
# - 5 —Ç–æ–≤–∞—Ä–æ–≤ –æ—à–∏–±–æ—á–Ω–æ –æ—Ç–Ω–µ—Å–µ–Ω—ã –∫ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (FP)
# - 10 —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–æ–ø—É—â–µ–Ω—ã (FN)
# - 40 —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–µ –æ—Ç–Ω–µ—Å–µ–Ω—ã –∫ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (TN)

result = calc.calculate_classification_metrics(
    true_positives=45,
    false_positives=5,
    false_negatives=10,
    true_negatives=40
)

print(f"Precision: {result.precision:.3f}")  # 45/(45+5) = 0.900
print(f"Recall: {result.recall:.3f}")        # 45/(45+10) = 0.818
print(f"F1 Score: {result.f1_score:.3f}")    # 0.857
print(f"Accuracy: {result.accuracy:.3f}")    # (45+40)/100 = 0.850
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- **Precision 90%** - –ò–∑ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ—Ç–Ω–µ—Å–ª–∏ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, 90% –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ –Ω–µ–π
- **Recall 82%** - –ò–∑ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º—ã –Ω–∞—à–ª–∏ 82%
- **F1 Score 86%** - –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ, –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É precision –∏ recall

---

### –ü—Ä–∏–º–µ—Ä 2: Link Accuracy

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤

```python
# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
pred_links = [
    "https://sdvor.com/ekb/category/instrument-i-oborudovanie-5991",
    "https://market.yandex.ru/search?text=Bosch+GSR&lr=54",
    "https://www.avito.ru/ekaterinburg?q=Bosch+GSR"
]

# –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
true_links = [
    "https://sdvor.com/ekb/category/instrument-i-oborudovanie-5991",
    "https://market.yandex.ru/search?text=Bosch+GSR+12V-15&lr=54",
    "https://www.avito.ru/ekaterinburg?q=Bosch+GSR+12V-15"
]

link_acc = calc.calculate_link_accuracy(pred_links, true_links, check_params=True)

print(f"Exact Match: {link_acc['exact_match_ratio']:.3f}")      # 1/3 = 0.333
print(f"Domain Match: {link_acc['domain_match_ratio']:.3f}")    # 3/3 = 1.000
print(f"Params Match: {link_acc['params_match_ratio']:.3f}")    # 3/3 = 1.000
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- **Domain Match 100%** - –í—Å–µ –¥–æ–º–µ–Ω—ã –≤–µ—Ä–Ω—ã–µ (sdvor, yandex, avito)
- **Params Match 100%** - –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç (lr=54, /ekaterinburg)
- **Exact Match 33%** - –¢–æ–ª—å–∫–æ 1 —Å—Å—ã–ª–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤)

---

## üß™ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª–Ω—ã–π workflow A/B —Ç–µ—Å—Ç–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

```python
from prompt_engineering.prompt_manager import PromptManager

manager = PromptManager()

# –°–æ–∑–¥–∞—Ç—å baseline (v1.0.0)
manager.create_prompt(
    prompt_name="vision_baseline",
    prompt_text="–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –∏ –¥–∞–π 3 —Å—Å—ã–ª–∫–∏.",
    description="–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –±–µ–∑ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π"
)

# –°–æ–∑–¥–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (v1.0.0)
manager.create_prompt(
    prompt_name="vision_optimized",
    prompt_text="""–¢—ã ‚Äî AI-—ç–∫—Å–ø–µ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –∫–æ–º–ø–∞–Ω–∏–∏ \"–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –î–≤–æ—Ä\".
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏:
1. –ë—Ä–µ–Ω–¥ (–µ—Å–ª–∏ –≤–∏–¥–µ–Ω)
2. –ú–æ–¥–µ–ª—å (–µ—Å–ª–∏ –≤–∏–¥–Ω–∞)
3. –¢–∏–ø —Ç–æ–≤–∞—Ä–∞

–°–æ–∑–¥–∞–π 4 —Ç–æ—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –≤ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–µ:
1. sdvor.com - –ü–†–ò–û–†–ò–¢–ï–¢ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞)
2. Yandex Market - —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ + lr=54
3. Google - —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ + "–∫—É–ø–∏—Ç—å –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥"
4. Avito - —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ + /ekaterinburg""",
    description="–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏"
)
```

#### –®–∞–≥ 2: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
# –°–æ–∑–¥–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç —Å ground truth
test_data = [
    {
        "image": "data/products/bosch_gsr_12v.png",
        "ground_truth": {
            "brand": "BOSCH",
            "model": "GSR 12V-15",
            "type": "–î—Ä–µ–ª—å-—à—É—Ä—É–ø–æ–≤—ë—Ä—Ç",
            "links": [
                "https://sdvor.com/ekb/category/instrument-i-oborudovanie-5991",
                "https://market.yandex.ru/search?text=Bosch+GSR+12V-15&lr=54",
                "https://www.google.com/search?q=Bosch+GSR+12V-15+–∫—É–ø–∏—Ç—å+–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",
                "https://www.avito.ru/ekaterinburg?q=Bosch+GSR+12V-15"
            ]
        }
    },
    # ... –µ—â—ë 49 —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
]
```

#### –®–∞–≥ 3: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ executor –∏ metrics —Ñ—É–Ω–∫—Ü–∏–π

```python
from src.llm_client import GeminiClient
from prompt_engineering.metrics_calculator import MetricsCalculator

client = GeminiClient()
calc = MetricsCalculator()

def executor_func(prompt_text: str, data: dict) -> str:
    """–í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–º–ø—Ç –Ω–∞ Vision API"""
    with open(data["image"], 'rb') as f:
        image_bytes = f.read()

    return client.generate_with_image(
        system_prompt=prompt_text,
        user_text="–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ.",
        image_bytes=image_bytes
    )

def metrics_func(output: str, data: dict) -> dict:
    """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è output"""
    ground_truth = data["ground_truth"]

    # –ò–∑–≤–ª–µ—á—å —Å—Å—ã–ª–∫–∏ –∏–∑ output
    import re
    pred_links = re.findall(r'https?://[^\s<>"]+', output)

    # Link accuracy
    link_acc = calc.calculate_link_accuracy(
        pred_links,
        ground_truth["links"],
        check_params=True
    )

    # Text similarity –¥–ª—è –±—Ä–µ–Ω–¥–∞
    brand_sim = calc.calculate_text_similarity(
        predicted=output,
        ground_truth=ground_truth["brand"]
    )

    return {
        "exact_match_ratio": link_acc["exact_match_ratio"],
        "domain_match": link_acc["domain_match_ratio"],
        "params_match": link_acc["params_match_ratio"],
        "brand_match": brand_sim["word_overlap"]
    }
```

#### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ A/B —Ç–µ—Å—Ç–∞

```python
from prompt_engineering.ab_testing import ABTester, PromptVariant

tester = ABTester()

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã
baseline = manager.get_prompt("vision_baseline")
optimized = manager.get_prompt("vision_optimized")

# –°–æ–∑–¥–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã
variant_a = PromptVariant(
    name="baseline",
    prompt_text=baseline.prompt_text,
    version=baseline.version,
    description=baseline.description
)

variant_b = PromptVariant(
    name="optimized",
    prompt_text=optimized.prompt_text,
    version=optimized.version,
    description=optimized.description
)

# –ó–∞–ø—É—Å—Ç–∏—Ç—å A/B —Ç–µ—Å—Ç
report = tester.run_ab_test(
    test_name="vision_baseline_vs_optimized",
    variant_a=variant_a,
    variant_b=variant_b,
    test_data=test_data,
    executor_func=executor_func,
    metrics_func=metrics_func,
    sample_size=50  # –ü–µ—Ä–≤—ã–µ 50 —Ç–æ–≤–∞—Ä–æ–≤
)
```

#### –®–∞–≥ 5: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```
üèÜ –ü–û–ë–ï–î–ò–¢–ï–õ–¨: Variant B (optimized)
–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 95.0%

üìà –ú–ï–¢–†–ò–ö–ò –í–ê–†–ò–ê–ù–¢–ê A (baseline):
  exact_match_ratio: 0.412 (¬±0.089)
  domain_match: 0.983 (¬±0.021)
  params_match: 0.734 (¬±0.112)
  brand_match: 0.891 (¬±0.067)
  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 4.2s (¬±0.8s)

üìà –ú–ï–¢–†–ò–ö–ò –í–ê–†–ò–ê–ù–¢–ê B (optimized):
  exact_match_ratio: 0.876 (¬±0.042)
  domain_match: 1.000 (¬±0.000)
  params_match: 0.989 (¬±0.015)
  brand_match: 0.967 (¬±0.028)
  –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 4.5s (¬±0.7s)

üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
  üéâ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–µ–¥—Ä–∏—Ç—å optimized - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–ª—É—á—à–µ–Ω–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å baseline
  üìà –û–∂–∏–¥–∞–µ–º–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
  ‚ö° –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º–∞ (—Ä–∞–∑–Ω–∏—Ü–∞ ~7%)

üíæ –û—Ç—á—ë—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: prompt_engineering/experiments/vision_baseline_vs_optimized_20251122_172345
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- **exact_match_ratio:** –í—ã—Ä–æ—Å —Å 41% –¥–æ 88% (+113%) - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Å—ã–ª–æ–∫
- **params_match:** –í—ã—Ä–æ—Å —Å 73% –¥–æ 99% (+35%) - —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–ø–µ—Ä—å –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **brand_match:** –í—ã—Ä–æ—Å —Å 89% –¥–æ 97% (+9%) - —É–ª—É—á—à–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –±—Ä–µ–Ω–¥–∞
- **–°–∫–æ—Ä–æ—Å—Ç—å:** –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è (4.2s vs 4.5s)

**–†–µ—à–µ–Ω–∏–µ:** –í–Ω–µ–¥—Ä–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –≤ production

---

## üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Semantic Versioning)

**–§–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–∏:** `MAJOR.MINOR.PATCH`

- **MAJOR** - –ö–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –≤–µ—Ä—Å–∏—è–º–∏
- **MINOR** - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ
- **PATCH** - –ú–µ–ª–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, bug fixes

**–ü—Ä–∏–º–µ—Ä—ã:**
```python
# 1.0.0 ‚Üí 1.1.0 (–¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏)
manager.update_prompt(..., version_type="minor")

# 1.1.0 ‚Üí 2.0.0 (–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –ø—Ä–æ–º–ø—Ç)
manager.update_prompt(..., version_type="major")

# 2.0.0 ‚Üí 2.0.1 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–ø–µ—á–∞—Ç–∫–∞)
manager.update_prompt(..., version_type="patch")
```

### –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ö–∞–∂–¥–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ–º–ø—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- **version** - –ù–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏
- **prompt_text** - –¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞
- **description** - –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **author** - –ê–≤—Ç–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **created_at** - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- **hash** - SHA256 —Ö—ç—à –ø—Ä–æ–º–ø—Ç–∞
- **parent_version** - –ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤–µ—Ä—Å–∏—è

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π

```python
comparison = manager.compare_versions(
    "vision_product_detection",
    "1.0.0",
    "2.0.0"
)

print(f"–°—Ö–æ–∂–µ—Å—Ç—å: {comparison['similarity']*100:.1f}%")
print(f"–ò–∑–º–µ–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫: {comparison['lines_changed']}")

# Diff (unified format)
for line in comparison['diff']:
    print(line)
```

**–í—ã–≤–æ–¥:**
```
--- vision_product_detection v1.0.0
+++ vision_product_detection v2.0.0
@@ -1,1 +1,10 @@
-–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ.
+–¢—ã ‚Äî AI-—ç–∫—Å–ø–µ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –∫–æ–º–ø–∞–Ω–∏–∏ "–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –î–≤–æ—Ä".
+–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏:
+1. –ë—Ä–µ–Ω–¥ (–µ—Å–ª–∏ –≤–∏–¥–µ–Ω)
+2. –ú–æ–¥–µ–ª—å (–µ—Å–ª–∏ –≤–∏–¥–Ω–∞)
+3. –¢–∏–ø —Ç–æ–≤–∞—Ä–∞
+...
```

### Rollback

–û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Å–æ–∑–¥–∞—ë—Ç –ù–û–í–£–Æ –≤–µ—Ä—Å–∏—é (–Ω–µ —É–¥–∞–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é):

```python
# –¢–µ–∫—É—â–∞—è: 2.0.0
# –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º—Å—è –∫: 1.0.0
manager.rollback("vision_product_detection", target_version="1.0.0")
# ‚Üí –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è 2.0.1 —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º 1.0.0

# –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π:
# 1.0.0 - –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç
# 1.1.0 - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
# 2.0.0 - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω
# 2.0.1 - Rollback to 1.0.0 (—Ç–µ–∫—É—â–∞—è)
```

---

## üíª CLI –∫–æ–º–∞–Ω–¥—ã

### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

```bash
# METRICS
./prompt_engineering_cli.py metrics --test-results results.json

# A/B TEST
./prompt_engineering_cli.py ab-test --variant-a baseline --variant-b optimized --test-data products.json

# PROMPT MANAGEMENT
./prompt_engineering_cli.py prompt list
./prompt_engineering_cli.py prompt create --name NAME --text "TEXT" --description "DESC"
./prompt_engineering_cli.py prompt update --name NAME --text "TEXT" --version-type minor
./prompt_engineering_cli.py prompt show --name NAME [--version VERSION]
./prompt_engineering_cli.py prompt versions --name NAME
./prompt_engineering_cli.py prompt compare --name NAME --version V1 --version2 V2
./prompt_engineering_cli.py prompt export --name NAME [--output FILE]

# BENCHMARK
./prompt_engineering_cli.py benchmark --prompt NAME --dataset data.json

# REPORT
./prompt_engineering_cli.py report --experiment-dir prompt_engineering/experiments
```

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç
./prompt_engineering_cli.py prompt create \
  --name vision_v1 \
  --text "–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ." \
  --description "–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç"

# 2. –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç
./prompt_engineering_cli.py prompt update \
  --name vision_v1 \
  --text "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–æ–≤–∞—Ä –¥–µ—Ç–∞–ª—å–Ω–æ..." \
  --description "–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏" \
  --version-type minor

# 3. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
./prompt_engineering_cli.py prompt list

# 4. –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–º–ø—Ç
./prompt_engineering_cli.py prompt show --name vision_v1

# 5. –°–ø–∏—Å–æ–∫ –≤–µ—Ä—Å–∏–π
./prompt_engineering_cli.py prompt versions --name vision_v1

# 6. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
./prompt_engineering_cli.py prompt compare \
  --name vision_v1 \
  --version 1.0.0 \
  --version2 1.1.0

# 7. –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–º–ø—Ç–∞
./prompt_engineering_cli.py prompt export \
  --name vision_v1 \
  --output vision_v1_export.json

# 8. –ó–∞–ø—É—Å–∫ A/B —Ç–µ—Å—Ç–∞
./prompt_engineering_cli.py ab-test \
  --variant-a vision_baseline \
  --variant-b vision_optimized \
  --test-data data/products.json

# 9. –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á—ë—Ç–æ–≤
./prompt_engineering_cli.py report \
  --experiment-dir prompt_engineering/experiments
```

---

## üéì Best Practices

### 1. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û:**
```python
# –°–æ–∑–¥–∞—Ç—å baseline
manager.create_prompt("vision_v1", "–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä.", "Baseline")

# –°–¥–µ–ª–∞—Ç—å minor update
manager.update_prompt("vision_v1", "–û–ø–∏—à–∏ —Ç–æ–≤–∞—Ä –¥–µ—Ç–∞–ª—å–Ω–æ.", "–£–ª—É—á—à–µ–Ω–∏–µ", version_type="minor")
```

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
```python
# –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–º–ø—Ç –±–µ–∑ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
# (–ø–æ—Ç–µ—Ä—è –∏—Å—Ç–æ—Ä–∏–∏)
```

### 2. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ (–º–∏–Ω–∏–º—É–º 30-50 –ø—Ä–∏–º–µ—Ä–æ–≤)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ production
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å (confidence > 80%)
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 3-5 –ø—Ä–∏–º–µ—Ä–∞—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –í–Ω–µ–¥—Ä—è—Ç—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ confidence level

### 3. –ú–µ—Ç—Ä–∏–∫–∏

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç—Ä–∏–∫ (F1, accuracy, precision, recall)
- –£—á–∏—Ç—ã–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –º–µ—Ç—Ä–∏–∫
- –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å baseline

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
- –ü–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω—É –º–µ—Ç—Ä–∏–∫—É
- –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å false positives/negatives
- –ù–µ —É—á–∏—Ç—ã–≤–∞—Ç—å trade-off –º–µ–∂–¥—É precision –∏ recall

### 4. Ground Truth

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å ground truth
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø–µ—Ä—Ç–∞–º–∏

‚ùå **–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ ground truth

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **Metrics Calculator** - 100% –≥–æ—Ç–æ–≤
   - Classification metrics (F1, Precision, Recall, Accuracy)
   - Text similarity (BLEU, Exact Match, Fuzzy Match)
   - Link quality metrics
   - Category matching metrics

2. **A/B Testing Framework** - 100% –≥–æ—Ç–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ A/B —Ç–µ—Å—Ç–æ–≤
   - –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ–±–æ–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤

3. **Prompt Manager** - 100% –≥–æ—Ç–æ–≤
   - Semantic versioning
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π (diff)
   - Rollback
   - Export/Import

4. **CLI Interface** - 100% –≥–æ—Ç–æ–≤
   - –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
   - Help —Å–∏—Å—Ç–µ–º–∞
   - –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### üéØ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ ConstructionAI:

**–¢–µ–∫—É—â–∏–π –ø—Ä–æ–º–ø—Ç (VISION_SYSTEM_PROMPT):**
- –í–µ—Ä—Å–∏—è: 2.0.0 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
- –¢–æ—á–Ω–æ—Å—Ç—å: 100% –ø–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 6 —Ç–æ–≤–∞—Ä–∞—Ö
- sdvor.com - –ø–µ—Ä–≤–∞—è —Å—Å—ã–ª–∫–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–æ–º–ø—Ç–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å A/B —Ç–µ—Å—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ò–∑–º–µ—Ä–∏—Ç—å F1 score, precision, recall
4. –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫

---

## üöÄ –î–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è –≤ –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –î–≤–æ—Ä

### –ß—Ç–æ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:

1. **–ü–æ–ª–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –¥–ª—è –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–µ–Ω–µ—Ä–∞
   - –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (F1, BLEU, Similarity)
   - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
   - CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

2. **–†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
   - 100% —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º
   - sdvor.com –∫–∞–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è —Å—Å—ã–ª–∫–∞
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 6 —Ç–æ–≤–∞—Ä–∞—Ö

3. **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–±–æ—Ç–µ**
   - –ú–æ–∂–Ω–æ —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞—Ç—å A/B —Ç–µ—Å—Ç—ã –ø—Ä–æ–º–ø—Ç–æ–≤
   - –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –æ—Ç –Ω–∞—á–∞–ª—å—Å—Ç–≤–∞
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è

4. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥**
   - Semantic versioning
   - Experiment tracking
   - Ground truth validation
   - Statistical significance

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–ü—Ä–æ–µ–∫—Ç:** ConstructionAI_System
**–ü–æ–∑–∏—Ü–∏—è:** Prompt Engineer
**–ö–æ–º–ø–∞–Ω–∏—è:** –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –î–≤–æ—Ä

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production!** üöÄ
